%   Supporting Calculations for Geometric, Inertial, and Aerodynamic 
%   Properties of Powered Parachute
%   为AeroModel函数准备几何,惯性,气动数据



    clear
    disp('==============================================================')
    %disp('***************** ENTER IN PGEOMASSAERO *******************')
    disp('==============================================================')
    Date    =   date
    
    
    
    %结构质量    单位: KG
    WingSys = 5;                         %翼伞质量
    BodySys = 135;                     %载荷仓质量
    m  = WingSys + BodySys;
    %计算质心
    Lz = 7;
    CWing = Lz*BodySys/m;            %质心与翼伞距离
    CBody = Lz*WingSys/m;            %质心与载荷仓距离
    CRoll = 3.5;                                  %滚转中心
    CPitch = 3.5;                                %俯仰中心
   
    
    %几何特征
    S = 37.5                                    %伞翼面积
    Sb = 0.5                                    %载荷仓面积
    cBar = 3.75                                 %伞翼平均气动弦长
    b = 10                                      %展长
    r = 6.3662;                                 %伞翼圆弧半径
    Mtheta = pi/2;                              %圆心角的一半
    xcp = -1.5                                %机翼压心在本体系中的位置
    xcm     =   xcp + 0.45*cBar    %   (计算质心)Center of mass from nose (USER-specified), m
    lWing   =   xcm - xcp              % Horizontal distance between c.m and wing c.p., m
    zWing   =   -3                    % Vertical distance between c.m and wing c.p., m
    emax= 0.18*cBar            %伞翼最大厚度
    Slong = emax*b         %伞翼纵向投影面积
    Slat = emax* cBar      %翼伞横向投影面积
    
    
    %惯性积（考虑了附加质量）
    %   Moments and Product of Inertia
    Jp= WingSys*[  1/12*b*b+CWing*CWing              0             1/4*cBar*CWing;
                               0       7/48*cBar*cBar+CWing*CWing     0        ;
                               1/4*cBar*CWing      0              1/12*b*b+7/48*cBar*cBar
                          ]
                      
    Jb= BodySys*[ 1/6*Sb+CBody*CBody    0             0;
                                0       1/6*Sb+CBody*CBody       0;
                                 0                   0                       1/6*Sb
                            ]
    Jr= Jp+ Jb
    
    
    
    Ixx     =  Jr(1,1)
    Iyy     =   Jr(2,2)
    Izz     =   Jr(3,3)
    Ixz     =   Jr(1,3)
    
    
    %   Maximum Aileron Deflection is  35 deg
    dAmax   =   35 * 0.01745329 
    
    save('/home/ldp/app/R2013b_UNIX/ldp workspace/PoweredParachute/InerGeo.mat','m','xcm','Ixx','Iyy','Izz','Ixz','cBar','b','S', ...
       'xcp','Lz','lWing','CWing','CBody','CRoll','CPitch','emax', 'Slong','Slat','Sb',...
       'r', 'Mtheta')
    
    
    
    
    disp('===================================')
    disp('Aerodynamic Properties for Power Parachute')
    disp('===================================')
    
    %   Power Parachute Aero Properties    
    AlphaTable	=	[-10 -8 -6 -4 -2 0 2 4 6 8 10 11 12 13 14 15 16 17 18 19 20 ...
					21 22 23 24 25 30 35 40 45 50 55 60 65 70 75 80 85 90];
    Points      =   length(AlphaTable);
    AlphaRad    =   0.0174533*AlphaTable;       %将角度转化为弧度
    SinAlpha    =   sin(AlphaRad);
    CosAlpha    =   cos(AlphaRad);
    
  
    %   Longitudinal Aerodynamics
    %   =========================
    %   Lift(升力系数表)
  
    figure
    %CLTable         =   [-1.10414493484302,-0.883315947874415,-0.662486960905811,-0.441657973937207,-0.220828986968604,0,0.220828986968604,0.441657973937207,0.662486960905811,0.883315947874415,1.10414493484302,1.21170652584920,1.28853623371075,1.33463405842769,1.35000000000000,1.33463405842769,1.28853623371075,1.21170652584920,1.10414493484302,0.965851460692216,0.796826103396791,0.730000000000000,0.730000000000000,0.740000000000000,0.760000000000000,0.780000000000000,0.972831540445641,1.21091619655235,1.42218430518409,1.58862675882105,1.69489278019590,1.72936655653370,1.68499212712194,1.55979005609270,1.35703040737636,1.08504994405072,0.756725704861244,0.388640515367069,-3.02492158249372e-06]
    %CLTable            =   [0.350, 0.430, 0.510, 0.590, 0.670, 0.760, 0.808, 0.856, 0.904, 0.952, 1.000, 0.978, 0.957, 0.935, 0.914, 0.893, 0.871, 0.8782, 0.8855, 0.8928, 0.900, 0.876, 0.852, 0.828, 0.804, 0.780, 0.700, 0.636, 0.573, 0.510, 0.446, 0.383, 0.320, 0.240, 0.160, 0.080      0      0      0];
    %                            [-10         -8      -6         -4        -2        0         2         4         6         8        10        11      12       13       14       15       16       17         18       19         20         21          22    23       24        25      30       35        40      45         50      55      60      65        70       75      80    85    90]
    CDTable0   =    [0.0127530364372517,0.0255060728745033,0.0579890880748922,0.151459854014820,0.264848012470816,0.358144972719758,0.471918876755364,0.570202808112033,0.677767776777901,0.702857142857378,0.681574239714041,0.675939177102190,0.670304114490393,0.664669051878720,0.660322333077901,0.657904834996536,0.655913978495000,0.655913978495000,0.656571867794308,0.658993082244745,0.661787365177459,0.671494607088143,0.681201848998828,0.685629709365206,0.688172043011000,0.688172043011000,0.646428571428721,0.578363914372943,0.554892601431900,0.529096477794762,0.507382550335358,0.482745398773036,0.462466487935791,0.402096342552062,0.339083878643605,0.263368983957462,0.190763052208986,0.134903640256850,0.0926174496643920]
    CDTable45 =    [0.190000000000000,0.220721866422686,0.258855585831008,0.344686648501171,0.456204379562198,0.565789473683963,0.687956204379852,0.797971918876777,0.883243243243761,0.896246648793972,0.879019908116807,0.869372128637186,0.860358744394098,0.863183856501802,0.864343163538155,0.855898123323765,0.847453083109375,0.844086021505000,0.844788164088322,0.846906523200689,0.849024882313056,0.846777658431271,0.842790073775366,0.836452045606418,0.830114017437470,0.821275455519283,0.724689165187278,0.645771292436169,0.612299465239913,0.556970509383069,0.508383635144208,0.456157965193848,0.404549509366461,0.330960854092698,0.235804943219106,0.161635832522806,0.0840978593270984,0.0289961013645509,-0.000976085895527827]
    CDTable90 =    [0.300000000000000,0.373387580299842,0.446994535519196,0.550625000000022,0.658906250000261,0.779854147675363,0.880870917573556,0.945112781955116,0.938345864661902,0.927126436781883,0.913090128755598,0.903880463871650,0.889830508475007,0.876372155287934,0.863101604277197,0.846256684491926,0.839177101967512,0.833542039355641,0.827777777777097,0.807585470084825,0.787393162392553,0.767200854700282,0.748029392117183,0.729091516365864,0.713180076628402,0.705938697318011,0.649195949970717,0.580299785867319,0.512499999999584,0.454288266825676,0.401785714285983,0.327540106951368,0.269683985002436,0.182764140876249,0.116952789699015,0.0870635631154361,0.0577439570277328,0.0276584317937820,0.0132231404958800]
    
    plot(AlphaTable,CDTable0,AlphaTable,CDTable45,AlphaTable,CDTable90),grid, title('CLTable')
    xlabel('Alpha,deg'), ylabel('CL')
    legend('CLTable0 (blue)', 'CLTable45 (green)', 'CLTable90 (red)')
    
    %   Drag(阻力系数表)
    
    figure
    %CDTable         =   [0.0813550435243690,0.0613436742181042,0.0457792758687873,0.0346618484764181,0.0279913920409966,0.0257679065625227,0.0279913920409966,0.0346618484764181,0.0457792758687873,0.0613436742181042,0.0705452253508198,0.0811270091534428,0.0932960605264592,0.107290469605428,0.118019516565971,0.129821468222568,0.142803615044825,0.157083976549307,0.172792374204238,0.190071611624662,0.209078772787128,0.229986650065841,0.252985315072425,0.278283846579668,0.306112231237634,0.339165775094203,0.561664842825890,0.847893121418590,1.19335505107119,1.58862782829305,2.01989609406167,2.46979356322061,2.91849499945190,3.34498481591431,3.72841647598934,4.04947060702661,4.29161974980414,4.44221394754024,4.49331350328450];
    %plot(AlphaTable,CDTable), grid, title('CDTable')
    CDTable0   =    [0.0840000000000000,0.0849481720429874,0.0863629145682623,0.0917955822590131,0.0965779683317675,0.102517548464886,0.112118162903931,0.123101265823123,0.130162197722327,0.151918470123489,0.170182679033203,0.182264092243367,0.194678326754155,0.208782269406881,0.221380835715468,0.229821695930500,0.238262556145533,0.250861122453732,0.264965065105932,0.277379299617192,0.289460712828026,0.304552878726197,0.321396196697424,0.335904645238529,0.350413093779634,0.364588721019751,0.446219545392985,0.539191895622305,0.587924614517000,0.648459688762631,0.706165781951421,0.764409509550815,0.801935448052804,0.820835520815000,0.829015244317426,0.802079760446445,0.762617394854437,0.708756202284158,0.666649652919400]
    CDTable45 =    [0.110000000000000,0.117075627240094,0.123915397927120,0.128661941705676,0.149301982668687,0.171488362596792,0.192617394855420,0.210198040016348,0.244069007757890,0.278667849776510,0.317766278229557,0.337315492456080,0.355968649335068,0.370072591987268,0.384364706682612,0.399176534640000,0.413988362597389,0.432438183385996,0.452205208475494,0.475284061522535,0.496680374886386,0.511188823426384,0.525789437864935,0.542724921736310,0.559829376421720,0.577978377957780,0.671718777343776,0.732617394854874,0.789633523887125,0.832279453227063,0.865281128970265,0.905090513134941,0.938827072274439,0.952939975500143,0.954821695929771,0.901403877190138,0.837694199770613,0.765126355429128,0.693531373350000]
    CDTable90 =    [0.150000000000000,0.164324372759695,0.179153493165087,0.198462248926039,0.226864706682973,0.259660405607988,0.289284061521694,0.328262556144937,0.357474025679382,0.397796606324237,0.438999883334203,0.451081296544367,0.463961480875874,0.480896964747249,0.496703416360494,0.509391588403500,0.522079760446507,0.535391588403793,0.549015244318098,0.563119186970298,0.576327072274617,0.586891588403219,0.597456104531821,0.612617394854310,0.629552878725686,0.642494506990044,0.705512940170347,0.753238661282864,0.801058255070300,0.843262556145253,0.879860098387827,0.900431014926445,0.904821695930247,0.905224921736625,0.909929222811578,0.865520620661525,0.816864706683223,0.765843201307142,0.704284061522000]
    
    plot(AlphaTable,CDTable0,AlphaTable,CDTable45,AlphaTable,CDTable90),grid, title('CDTable')
    xlabel('Alpha,deg'), ylabel('CD')
    legend('CDTable0 (blue)', 'CDTable45 (green)', 'CDTable90 (red)')
    
    %   Lateral-Directional Aerodynamics
%   ================================
%   CYBetaTable(侧向力-侧滑角 系数表)
%   Side Force Sensitivity to Sideslip Angle
      
    figure
    CYBetaTable = [-0.648870630191512,-0.652468328898195,-0.655271094769849,-0.657275513065066,-0.658479141706816,-0.658880514257748,-0.658479141706816,-0.657275513065066,-0.655271094769849,-0.652468328898195,-0.648870630191512,-0.646775013095032,-0.644482381895247,-0.641993434950428,-0.639308930418575,-0.636429686026474,-0.633356578820611,-0.630090544900014,-0.626632579131105,-0.622983734844660,-0.619145123514947,-0.615117914421165,-0.610903334291269,-0.606502666928293,-0.601917252819295,-0.597148488727031,-0.570607189478796,-0.539723221256627,-0.504731629908286,-0.465898722800555,-0.423520042057638,-0.377918115305215,-0.329440001038360,-0.278454647294573,-0.225350083734032,-0.170530468497050,-0.114413012313954,-0.0574248032767895,4.43561724861952e-07];
    plot(AlphaTable, CYBetaTable), grid, title('CYBetaTable')
    
    
    
    %   CldATable, Roll Moment Sensitivity to Aileron Deflection(滚转力矩-副翼表)
    figure
    CldATable   =   [0.109879723720884,0.110488957860214,0.110963578108538,0.111303006213698,0.111506828634477,0.111574797044439,0.111506828634477,0.111303006213698,0.110963578108538,0.110488957860214,0.109879723720884,0.109524852014766,0.109136617949138,0.108715139783957,0.108260545905667,0.107772974788084,0.107252574950222,0.106699504911049,0.106113933141201,0.105496038011663,0.104846007739441,0.104164040330220,0.103450343518059,0.102705134702107,0.101928640880382,0.101121098580627,0.0966265961437879,0.0913967063356224,0.0854712318095601,0.0788952690432736,0.0717188651269599,0.0639966368744384,0.0557873551558634,0.0471534976155316,0.0381607731788775,0.0288776219674458,0.0193746944277950,0.00972431363847895,-7.51127228036274e-08];
    plot(AlphaTable, CldATable), grid, title('CldATable')
    
    
    %   ClBetaTable, Roll Moment Sensitivity to Sideslip Angle(滚转力矩-侧滑表)
    
    figure
    ClBetaTable =   [0.00273315190164909,-0.00680028067390678,-0.0164190961285897,-0.0260882584501516,-0.0357725845744313,-0.0454368157631068,-0.0550456891433348,-0.0645640092872919,-0.0739567197095453,-0.0831889741602776,-0.0922262075926827,-0.0965387017675830,-0.0994779349013999,-0.101055015325220,-0.101283471161002,-0.100179235757755,-0.0977606313023011,-0.0940483506151446,-0.0890654371430348,-0.0828372631607971,-0.0753915061960500,-0.0721769929672119,-0.0716824605966475,-0.0715680284690889,-0.0718247374747178,-0.0720471697343258,-0.0761367779685029,-0.0805317068221790,-0.0823773597096791,-0.0811784394392741,-0.0767769348108589,-0.0693734822286305,-0.0595056793767253,-0.0479859475222406,-0.0358064165918617,-0.0240222834136508,-0.0136276888400436,-0.00543906084564649,3.05882073447030e-08];
    plot(AlphaTable, ClBetaTable), grid, title('ClBetaTable')
    
    
    
    
    %   Pitching Moment (c.m. @ wing c.p.)(俯仰力矩表)
    figure
    CmTable         =   [0.146681149175663,0.117619086803684,0.0883741535184620,0.0589921826682437,0.0295189087697684,0,-0.0295189087697684,-0.0589921826682437,-0.0883741535184620,-0.117619086803684,-0.146431183983874,-0.160453916164061,-0.170421615607425,-0.176385633035138,-0.178235051816793,-0.176145295187666,-0.170182791654346,-0.160422460252220,-0.146947792845151,-0.129850946412764,-0.109232846970114,-0.0983095622731028,-0.0884786060457925,-0.0796307454412133,-0.0716676708970920,-0.0754664135070912,-0.122278914880603,-0.194012618843902,-0.253668919760856,-0.306974466289298,-0.360280006538578,-0.411965877257355,-0.460461628075459,-0.504293738884495,-0.542130392038978,-0.572821938996161,-0.595435831835118,-0.609284958277656,-0.613948519265042];
    plot(AlphaTable,CmTable), grid, title('CmTable')
    
    
    %   CndATable, Yaw Moment Sensitivity to Aileron Deflection
    CndATable   =   [0.00273315190164909,-0.00680028067390678,-0.0164190961285897,-0.0260882584501516,-0.0357725845744313,-0.0454368157631068,-0.0550456891433348,-0.0645640092872919,-0.0739567197095453,-0.0831889741602776,-0.0922262075926827,-0.0965387017675830,-0.0994779349013999,-0.101055015325220,-0.101283471161002,-0.100179235757755,-0.0977606313023011,-0.0940483506151446,-0.0890654371430348,-0.0828372631607971,-0.0753915061960500,-0.0721769929672119,-0.0716824605966475,-0.0715680284690889,-0.0718247374747178,-0.0720471697343258,-0.0761367779685029,-0.0805317068221790,-0.0823773597096791,-0.0811784394392741,-0.0767769348108589,-0.0693734822286305,-0.0595056793767253,-0.0479859475222406,-0.0358064165918617,-0.0240222834136508,-0.0136276888400436,-0.00543906084564649,3.05882073447030e-08];
    figure
    plot(AlphaTable, CndATable), grid, title('CndATable')
    
   CnBetaTable = [0.0945055283646115,0.0958882732428614,0.0971626169766501,0.0983249099584958,0.0993716313890952,0.100299396131161,0.101104961404247,0.101785233309260,0.102337273171598,0.102758303692017,0.103045714894635,0.103127547319115,0.103057106287996,0.102835492808735,0.102464034245359,0.101944282974941,0.101278014877257,0.100467227658586,0.0995141390106920,0.0984211846061589,0.0971910159312839,0.0963138449097102,0.0956539349843548,0.0950010360520145,0.0943545381182128,0.0936781838176769,0.0901702901792574,0.0860557173597463,0.0811120592884932,0.0753336588599997,0.0687494618486525,0.0614246096214750,0.0534581303371169,0.0449769648814814,0.0361270026640453,0.0270621601883803,0.0179327688827380,0.00887461987852139,-6.75220573667606e-08]
   figure
   plot(AlphaTable, CnBetaTable), grid, title('CnBetaTable')
    
    save('/home/ldp/app/R2013b_UNIX/ldp workspace/PoweredParachute/DataTable.mat','AlphaTable',...
        'CLTable0','CLTable45','CLTable90','CDTable0','CDTable45','CDTable90','CmTable', ...
        'CYBetaTable','ClBetaTable','CldATable','CndATable' ,'CnBetaTable')
    
    
    
    